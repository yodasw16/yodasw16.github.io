---
layout: slides
title:  "Talks: Responsive Images: Using SVG, Picture, and other techniques to make sites faster"
---
<section>
    <h1>Responsive Images</h1>
    <h2>Using SVG, Picture, and other techniques to make sites faster</h2>
</section>

<section>
    <h2>We are getting fat!</h2>
    <img src="/img/talks/responsive-images/fat.jpg">

    <aside class="notes">
        well, not this kind of fat
    </aside>
</section>

<section>
    <h2>Web pages are getting huge!</h2>
    <ul>
        <li class="fragment">Average webpage weight is 1.8mb</li>
        <li class="fragment">Up ~17% from last year and ~44% since 2012</li>
        <li class="fragment">1.1mb of this is images<br>
            <img style="margin: 10px auto; display: block" width="500" src="/img/talks/responsive-images/avg-bytes.png">
            <cite class="cite">- httparchive.org</cite>
        </li>
    </ul>
</section>

<section>
    <h2>This isn't us though, right?</h2>
    <h4 class="fragment">Well...</h4>

    <aside class="notes">
        Our sites aren't can't be that big, right?
    </aside>
</section>

<section>
    <h2>Quicken Loans</h2>
    <div class="fragment">
        <img width="250" src="/img/talks/responsive-images/ql-bytes.png">
        <p>&gt; 2mb</p>
    </div>
    <div class="fragment">
        <img width="350" src="/img/talks/responsive-images/ql-img-weight.png">
        <p>&gt; 1mb</p>
        <cite class="cite">- webpagetest.org</cite>
    </div>

    <aside class="notes">
        Let's talk about quickenloans.com. I don't want to pick on the venture folks here since they got picked on a lot last time, but ql.com is our biggest site and has the most room for improvement, so it makes for a great example.
    </aside>
</section>

<section>
    <h2>Agent Insight</h2>
    <div class="fragment">
        <div style="width: 45%; float:left">
            <p>Large Screen</p>
            <img width="250" src="/img/talks/responsive-images/ai-bytes-large.png">
            <p>~2.5mb</p>
        </div>
        <div style="width: 45%; float:right">
            <p>Small Screen</p>
            <img width="250" src="/img/talks/responsive-images/ai-bytes-small.png">
            <p>~2.2mb</p>
        </div>
    </div>
    <div class="fragment" style="clear: left;">
        <div style="width: 45%; float:left">
            <img width="250" src="/img/talks/responsive-images/ai-img-weight-large.png">
            <p>&gt; 1.5mb</p>
        </div>
        <div style="width: 45%; float:right">
            <img width="250" src="/img/talks/responsive-images/ai-img-weight-small.png">
            <p>&gt; 1.5mb</p>
        </div>
        <cite class="cite" style="clear: left;">- webpagetest.org</cite>
    </div>

    <aside class="notes">
        Another good example is Agent Insight, which is a responsive site with a  decent amount of images being used. Again, lots of room for improvement.
    </aside>
</section>

<section>
    <h2>This is a <i><u>real</u></i> problem</h2>
    <div class="fragment">
        <img width="500" src="/img/talks/responsive-images/it-gets-better.gif">
    </div>
    <aside class="notes">
        This is a real problem. Right? Images are typically the #1 contributor to page weight. I'm here to tell you, it gets better.
    </aside>
</section>

<section>
    <h2>Actually, it doesn't</h2>
    <img width="500" src="/img/talks/responsive-images/sorry.gif">
    <div class="fragment">
        <p>RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA RETINA</p>
    </div>
    <aside class="notes">
        Before it gets better, it actually gets worse. We already have a weight problem. Now we also have to worry about providing higher resolution images to devices that support them. We have more pixels to deal with so our images have to get larger to fill the available space.
    </aside>
</section>

<section>
    <h2>We can handle it!</h2>
    <img width="500" src="/img/talks/responsive-images/hit-with-knowledge.gif">
    <aside class="notes">
        The good news is that there are techniques and tools available to help us deliver the right images to the right browsers while keeping our file size low.
    </aside>
</section>

<section>
    <h2>Our Goal</h2>
    <p>To deliver the smallest possible file that fills up all of the available pixels</p>
    <aside class="notes">
        I am going to talk about a couple of techniques today that will help us meet those goals. The first technique is SVG.
    </aside>
</section>

<section>
    <h2>SVG</h2>
    <aside class="notes">
        The first technique that you should be using is SVG. If you don't know, SVG stands for Scalable Vector Graphic. It is a way to define what an image looks like using XML like markup. For any images other than photos, SVG should be your first choice.
    </aside>
</section>

<section>
    <h2>Why SVG?</h2>
    <ul>
        <li class="fragment">Small, highly optimizable files</li>
        <li class="fragment">Scalable to any size</li>
        <li class="fragment">Usable in multiple ways:
            <ul class="fragment">
                <li>as background in CSS</li>
                <li>as `src` on `img`</li>
                <li>inline using `svg` element</li>
                <li>using base64</li>
                <li>combined into one file like a sprite</li>
            </ul>
        </li>
        <li class="fragment">Controllable with CSS and JS</li>
    </ul>
    <aside class="notes">

    </aside>
</section>

<section>
    <h2>SVG for icons</h2>
    <p class="fragment"><a href="http://css-tricks.com/svg-symbol-good-choice-icons/">SVG `symbol` a Good Choice for Icons</a></p>
    <img class="fragment" width="700" src="/img/talks/responsive-images/svgicons1.png">

    <aside class="notes">
        My favorite use of SVG is for icons. We all got pretty hyped on icon fonts for a while because they offered a nice scalable alternative to sprited PNGs. A lot of performance and accessibility issues began to be realized so many people have moved to using svg instead. Chris Coyier posted a really great article with a system that I would recommend using. It works like this. SVG paths usually go in `g` element, instead we use `symbol`. This allows us to set the viewbox, which controlls the positioning of the icon in the svg file instead of in our markup.
    </aside>
</section>

<section>
    <h2>SVG for icons</h2>
    <p><a href="http://css-tricks.com/svg-symbol-good-choice-icons/">SVG `symbol` a Good Choice for Icons</a></p>
    <img width="700" src="/img/talks/responsive-images/svgicons2.png">

    <aside class="notes">
        Now you can easily drop in an icon with an inline svg element. You can then add a class and control the size or color or whatever.
    </aside>
</section>

<section>
    <h2>SVG for icons</h2>
    <div class="fragment">
        <h3>Tools for automating</h3>
        <ul>
            <li><a href="https://github.com/Hiswe/gulp-svg-symbols">Gulp SVG Symbols</a></li>
            <li><a href="https://github.com/FWeinb/grunt-svgstore">Grunt SVG Store</a></li>
        </ul>
    </div>
    <div style="margin-left: -5em" class="fragment">
        <h3>Other systems</h3>
        <ul style="margin-left: 3em">
            <li><a href="https://github.com/filamentgroup/grunticon">Grunticon</a></li>
            <li><a href="https://github.com/gavro/gulp-iconify">Gulp Iconify</a></li>
        </ul>
    </div>
    <aside class="notes">
        Of course there are tools available for automating this stuff! Alternatively systems like Grunticon and Gulp Iconify are pretty popular ways to handle making SVG icons as background images with png fallbacks.
    </aside>
</section>

<section>
    <h2>Other SVG stuff</h2>
    <h3>Optimization</h3>
    <ul class="fragment">
        <li><a href="https://github.com/sindresorhus/grunt-svgmin">Grunt SVGmin</a></li>
        <li><a href="https://github.com/ben-eb/gulp-svgmin">Gulp SVGmin</a></li>
            <li><a href="https://github.com/gruntjs/grunt-contrib-imagemin">Grunt ImageMin</a></li>
            <li><a href="https://github.com/sindresorhus/gulp-imagemin">Gulp ImageMin</a></li>
    </ul>

    <aside class="notes">
        Since SVG is just code, you can manually remove all the garbage, but who wants to do that? You can automate this stuff with SVGmin. There's also ImageMin, which includes the same SVGO optimizer that SVGmin uses, but it also covers png, jpg, and gif files.
    </aside>
</section>

<section>
    <h2>Other SVG stuff</h2>
    <h3>Browser Support</h3>
    <img src="/img/talks/responsive-images/svgbrowsersupport.png">
    <div class="fragment">
        <h3>Gotchas</h3>
        <p><a href="http://css-tricks.com/using-svg/">Using SVG - CSS Tricks</a></p>
    </div>

    <aside class="notes">
        Browser support for basic SVG is actually really awesome. IE9+, all versions of the other major browsers, android 4+. Of course, that comes with some gotchas. I'm not going to go into them, but Chris Coyier put together a nice roundup of all the issues. Mostly related to advanced features like filters.
    </aside>
</section>

<section>
    <h2>Give me bitmaps or give me death!</h2>
    <p>-Patrick Henry</p>
    <img src="/img/talks/responsive-images/patrickhenry.jpg">

    <aside class="notes">
        A lot of times, vector graphics just aren't an option. I would guess that most of the weight from images comes from photos. This is one of the real downsides that emerged after people started using responsive design. You basically had 2 choices: either send the same high resolution image to all screen sizes, which is terrible for performance on small screens or the same low resolution image to all screen sizes, which just looks bad if you are on a large or high resolution screen.
    </aside>
</section>

<section>
    <h2>Big images for everyone!</h2>
    <img src="/img/talks/responsive-images/fat.gif">
    <p style="font-size: 5em;">72%</p>
    <p>of responsive sites serve the same content to desktop &amp; mobile</p>
    <cite class="cite">- guypo.com</cite>

    <aside class="notes">
        Unfortunetly for performance reason, we have been choosing loading the largest image all of the time. According to this study, 72% use the large image everywhere.
    </aside>
</section>

<section>
    <h2>What can we do?</h2>
    <img class="fragment" src="/img/talks/responsive-images/yes-it-is.gif">

    <aside class="notes">
        Wouldn't it be nice if we could specify several images sources and tell the browser when to use each one? Or even better, let the browser decide which one to deliver? And what if we could do this without using UI sniffing or some JS solution that could easily fail?
    </aside>
</section>

<section>
    <h2>Enter Responsive Images</h2>
    <img src="/img/talks/responsive-images/excited.gif"><br>
    <img class="fragment" src="/img/talks/responsive-images/ricg.png">

    <aside class="notes">
        Developers have been looking for a solution to this problem for the last few years and started the Responsive Images Community Group through the W3C to address the problem.
    </aside>
</section>

<section>
    <h2>Picture Element</h2>
    <img class="fragment" src="/img/talks/responsive-images/picture1.png">

    <aside class="notes">
        The first technique I want to talk about is the new picture element. Here's what it looks like at it's core. Just a picture element that wraps an image element. So it has a built in fallback for browsers that don't understand the new element.
    </aside>
</section>

<section>
    <h2>Picture Element</h2>
    <img src="/img/talks/responsive-images/picture2.png">

    <aside class="notes">
        Then you can start adding in additional elements. Looks a lot like video or audio. Browser starts looking at these elements and the media queries on them. The first media query that resolves successfully is delivered to the browser. So if you are on a screen with a width greater than 1000px, you get the large image. If you are on a smaller screen you get medium, and if none match you get the fallback img, which should be the smallest.
    </aside>
</section>

<section>
    <h2>Picture Element</h2>
    <img src="/img/talks/responsive-images/picture3.png">

    <aside class="notes">
        Optionally, there is a type attribute that allows you to specify the type of image that gets used. For example, if you want to provide a WebP file, which is a new image format that has way better compression than jpeg or png. Since it is only supported by Chrome and Opera, you can't give this to everyone, but using picture, you can give the option and if the browser supports it, it will choose that image. Then any browser inthe future will just get that image automatically.
    </aside>
</section>

<section>
    <h2>Picture Element</h2>
    <img src="/img/talks/responsive-images/picture4.png">

    <aside class="notes">
        What if you have a big image like this one form Nathan's hot dog eating contest? What happens when the screen gets smaller?
    </aside>
</section>

<section>
    <h2>Picture Element</h2>
    <img src="/img/talks/responsive-images/picture5.png"><br>
    <img class="fragment" src="/img/talks/responsive-images/picture6.png">

    <aside class="notes">
        The picture loses effectiveness and is harder to make out what's in it. What we'd like to do is crop that image so it looks better at a smaller size. This is called art direction, and it's really simple to do with the picture element. You just change the source of the smallest file to this nice cropped image and the browser will load it when you tell it to.
    </aside>
</section>

<section>
    <h2>Picture Element</h2>
    <h3>Browser support</h3>
    <img src="/img/talks/responsive-images/picture7.png">

    <aside class="notes">
        This is a brand new spec so browser support is still catching up, but has suprisingly good support. Out of the box support is available in the latest chrome and opera and it is available in FF behind an experimental flag that you have to turn on. IE has it listed as Under Consideration. Only Safari has yet to say anything about upcoming support. Since there is a built in fallback to the img element, you're never going to not get anything. There are also polyfills available, but I'll touch on that later.
    </aside>
</section>

<section>
    <h2>Picture Element FTW!!</h2>
    <h3>Time to party</h3>
    <img src="/img/talks/responsive-images/time-to-party.gif">

    <aside class="notes">
        Since the picture element only has media queries, the screen width is the only factor that is getting looked at. This isn't really enough to meet our goal of delivering the smallest image that fills all of the pixels available.
    </aside>
</section>

<section>
    <h2>What do we need to know?</h2>
    <ul>
        <li class="fragment">Viewport Size</li>
        <li class="fragment">Screen Density</li>
        <li class="fragment">Render Size</li>
        <li class="fragment">Image Dimensions</li>
    </ul>

    <aside class="notes">
        Basically four things you need to know to determine the right image to download and display. How big is the screen? How dense is it, retina, 2x, 3x? How big is the image will be when it renders? If you're doing a 2 column layout, you only need the image to take up 50% of the viewport. Lastly need to know the actual image dimensions. For performance reasons, browsers are very agressive about prefetching assets, so you need to know all of this BEFORE the CSS gets parsed and before the images get downloaded. This is a really hard problem!
    </aside>
</section>

<section>
    <h2>What does the browser know?</h2>
    <ul style="width: 45%; float: left; list-style-type: none;">
        <li>Viewport Size</li>
        <li>Screen Density</li>
        <li>Render Size</li>
        <li>Image Dimensions</li>
    </ul>
    <ul style="width: 45%; float: right; list-style-type: none;">
        <li class="fragment">YES</li>
        <li class="fragment">YES</li>
        <li class="fragment">NO</li>
        <li class="fragment">NO</li>
    </ul>

    <aside class="notes">
        Lets look at what the browser knows. It knows viewport size and uses the media queries like we saw before. It knows whether the screen is retina or not. It doesn't know how big the image will be when rendered and it has no idea how big the actual image is until it starts downloading it. The browser only knows about 2 of these things.
    </aside>
</section>

<section>
    <h2>What do we know?</h2>
    <ul style="width: 45%; float: left; list-style-type: none;">
        <li>Viewport Size</li>
        <li>Screen Density</li>
        <li>Render Size</li>
        <li>Image Dimensions</li>
    </ul>
    <ul style="width: 45%; float: right; list-style-type: none;">
        <li class="fragment">NO</li>
        <li class="fragment">NO</li>
        <li class="fragment">YES</li>
        <li class="fragment">YES</li>
    </ul>

    <aside class="notes">
        When we are actually building a site, though, we know about some of these pieces, right? We don't know the stuff the browser knows, but we know how big we want the image when it renders on the screen and we know the image sizes because we saved them that way. We've never had a way to tell browsers these extra things that we know.
    </aside>
</section>

<section>
    <h2>srcset &amp; sizes</h2>

    <aside class="notes">
        This is were 2 new attributes come into play. scrset and sizes. These are applied to the image element to pass along that information to the browser so it knows what to download.
    </aside>
</section>

<section>
    <h2>Image Dimensions</h2>
    <h3>srcset</h3>
    <img class="fragment" src="/img/talks/responsive-images/picture8.png">

    <aside class="notes">
        Let's start with srcset. This allows us to tell the browser the actual dimensions of the image we want it to load. It's a simple comma separated list of keys and values. The first part is the URL to the image and the second is the width of the image itself. This w syntax is a little weird, but it corresponds to the actual px width of the image you want used.
    </aside>
</section>

<section>
    <h2>Rendered Size</h2>
    <h3>sizes</h3>
    <img class="fragment" src="/img/talks/responsive-images/picture9.png">

    <aside class="notes">
        Next is sizes. Again it's just a list of comma separated keys and values. Basically you have a media query that says whenever I'm being rendered on a screen that's at least 1024px wide, the image is going to be 300px wide. You can use any css measurement to make this work. So at 640px the image is going to use 50% of the vertical width of the screen. The last value is the fallback. If none of these match, display at 100% of the vertical width of the screen. You can use px, em, vw, calc, whatever.
    </aside>
</section>

<section>
    <h2>srcset &amp; sizes</h2>
    <img class="fragment" src="/img/talks/responsive-images/picture10.png">

    <aside class="notes">
        Let's put these together. We have an image tag, srcset that defines the available images that can be downloaded. We have sizes that say how big the image is going to be at each breakpoint. Then we have the regular src as a fallback.
    </aside>
</section>

<section>
    <h2>What about defining screen density?</h2>
    <img class="fragment" src="/img/talks/responsive-images/dont-even-care.gif">

    <aside class="notes">
        I didn't mention screen density at all with these attributes, because I don't have to. The browser is going to figure it out. If you're on a 2x display that's 500px logical wide and you've told it to display the image at 100% of the screen width, the browser will just look for the file that is 1000px wide or larger and use that one. Which means when Samsung comes out with a new phone that's like 7x, you just add a new image to your srcset and your fine.
    </aside>
</section>

<section>
    <h2>Highly Configurable</h2>
    <p><a href="https://dev.opera.com/articles/responsive-images/">Nearly every responsive images usecase</a></p>

    <aside class="notes">
        One of the best parts of this is that it is highly confgurable. The spec is really loose about which file will get downloaded and makes it really easy for browsers to make the decision. This means that in the future, browsers could add the ability to check the connection speed and optimize which image it chooses based on that instead. Or they could add features to allow the user to control what gets downloaded.
    </aside>
</section>

<section>
    <h2>Confused?</h2>
    <img src="/img/talks/responsive-images/confused.gif"><br>
    <img class="fragment" src="/img/talks/responsive-images/picture11.png">

    <aside class="notes">
        It's ok if you are confused. These features give a lot of power, so it takes actually trying to use them to really understand. [Show Crazy use case] The good news is that for most cases, this is really all you will need. You're providing the small image as the regular image source and your srcset simply gives a medium and large version of the image. Because typically you want an image to just take up all of the available space, we can leave sizes off and just let the default 100vw do it's thing.
    </aside>
</section>

<section>
    <h2>srcset &amp; sizes</h2>
    <h3>Browser support</h3>
    <img src="/img/talks/responsive-images/picture12.png"><br>

    <aside class="notes">
        Available in latest Chrome, Opera, and android, and it is available in FF behind an experimental flag. For Safari and ios srcset is available, but not sizes. IE has said that it is "under consideration". But remember, there are built in fallbacks so you don't really have to wait.
    </aside>
</section>

<section>
    <h2>Picturefill</h2>
    <h3>Picture, srcset, and sizes pollyfill</h3>
    <p><a href="https://github.com/scottjehl/picturefill">Picturefill</a></p>

    <aside class="notes">
        If you want all of the features now there is a JS pollyfill available by Scott Jehl of the Fillament Group. As it gets implemented natively, you won't need it anymore.
    </aside>
</section>

<section>
    <h2>Automating responsive images</h2>
    <h3>CMS plugins</h3>
    <ul>
        <li><a href="https://github.com/tevko/wp-tevko-responsive-images">Wordpress Responsive Images</a></li>
        <li><a href="https://www.drupal.org/project/resp_img">Drupal 8 core</a></li>
        <li><a href="https://github.com/mattdsteele/jekyll-picture-tag">Jekyll Picture Tag</a></li>
    </ul>

    <aside class="notes">
        It's not that hard to write this stuff on your own, but automation is always better. If you are using a popular CMS, there are plugins available already to auto-generate different sizes and write the markup for you. Probably others.
    </aside>
</section>

<section>
    <h2>Automating responsive images</h2>
    <h3>Build scripts</h3>
    <ul>
        <li><a href="https://github.com/mahnunchik/gulp-responsive">Gulp Responsive Images</a></li>
        <li><a href="https://github.com/andismith/grunt-responsive-images">Grunt Responsive Images</a></li>
    </ul>

    <aside class="notes">
        There are also gulp and grunt plugins for automating this stuff.
    </aside>
</section>

<section>
    <h2>Optimizing images</h2>
    <ul>
        <li><a href="https://github.com/gruntjs/grunt-contrib-imagemin">Grunt ImageMin</a></li>
        <li><a href="https://github.com/sindresorhus/gulp-imagemin">Gulp ImageMin</a></li>
        <li><a href="https://github.com/somerandomdude/grunt-webp">Grunt WebP</a></li>
        <li><a href="https://github.com/sindresorhus/gulp-webp">Gulp WebP</a></li>
        <li><a href="https://tinypng.com/">Tiny PNG</a></li>
        <li><a href="https://tinyjpg.com/">Tiny JPG</a></li>
        <li><a href="https://github.com/heldr/grunt-smushit">Grunt Smushit</a></li>
        <li><a href="https://github.com/heldr/gulp-smushit">Gulp Smushit</a></li>
    </ul>

    <aside class="notes">
        Last thing I want to give some links for are ways to optimize the file size of your bitmap images. I mentioned the first 2 when I was talking about optimizing SVGs. Those are probably your best bet since it covers everything, but you might want to use other compression algorythims depending on the situation.
    </aside>
</section>

<section>
    <h2>Time to lose weight!</h2>
    <img src="/img/talks/responsive-images/lose-weight.gif"><br>
    <p class="fragment">Questions?</p>

    <aside class="notes">
        Now that we have all of these awesome techniques available, there's no excuse to be loading 1.5 or more MB of images. It's time to lose weight!
    </aside>
</section>
